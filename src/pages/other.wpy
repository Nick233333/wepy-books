<template>
    <view>
        <i-tabs color="#fedb1d" current="{{ current }}" @change="handleChange">
            <i-tab key="audio" title="éŸ³é¢‘"></i-tab>
            <i-tab key="location" title="ä½ç½®"></i-tab>
            <i-tab key="video" title="è§†é¢‘"></i-tab>
        </i-tabs>
        <i-row wx:if="{{ current === 'audio' }}">
            <i-col span="24" i-class="collapse-box">
                <i-collapse name="description" accordion>
                    <i-collapse-item i-class="collapse-title" name="description" title="éŸ³é¢‘ç®€ä»‹:ã€Šæœªæ¥ä¸–ç•Œçš„å¹¸å­˜è€…ã€‹-- é˜®ä¸€å³°">
                        <view class="collapse-main" slot="content">
                            <text class="text">æœºå™¨äººã€è‡ªåŠ¨åŒ–ã€äººå·¥æ™ºèƒ½æ­£å˜å¾—æ¯”äººç±»æ›´å¼ºå¤§</text>
                            <text class="text">æŠ€æœ¯å˜é©å¯¼è‡´äººç±»ç¤¾ä¼šé‡æ„</text>
                            <text class="text">åœ¨å¯é¢„è§çš„æœªæ¥ï¼ŒæŠ€æœ¯ç»ˆå°†æ·˜æ±°äººç±»</text>
                            <text class="text">ä¸–ç•Œæ­£å‰§çƒˆå˜åŒ–ï¼Œæˆ‘ä»¬è¯¥ä½•å»ä½•ä»</text>
                            <text class="text">æœªæ¥çš„ä¸–ç•Œä¼šå¾ˆç³Ÿç³•ï¼Œä¸»è¦è¡¨ç°åœ¨ä¸‰ä¸ªæ–¹é¢ï¼š</text>
                            <text class="text">1. æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œä½¿å¾—å¤§éƒ¨åˆ†åŠ³åŠ¨è€…éƒ½æ²¡ç”¨äº†ã€‚</text>
                            <text class="text">2. å¤§éƒ¨åˆ†äººå¿…å®šåªèƒ½æ‰¾åˆ°ä½ç«¯å·¥ä½œï¼Œå·¥èµ„ä»…å¤Ÿæ¸©é¥±ã€‚</text>
                            <text class="text">3. è´«å¯Œåˆ†åŒ–å°†è¶Šæ¥è¶Šä¸¥é‡ï¼Œè€Œä¸”ä¼šä¸–è¢­ï¼Œç©·äººæ¯«æ— ç¿»èº«çš„å¯èƒ½ã€‚</text>
                            <text class="text">æˆ‘è§‰å¾—ï¼Œè¿™ä»¶äº‹æƒ…å¾ˆé‡è¦ï¼Œä¹Ÿè®¸æ˜¯æœ€é‡è¦çš„äº‹æƒ…ï¼Œä½†æ˜¯çœ‹åˆ°çš„äººå´ä¸å¤šã€‚æ‰€ä»¥ï¼Œæˆ‘å†™äº†ä¸€ç³»åˆ—æ–‡ç« ï¼Œè®²è¿°æˆ‘çš„è§‚ç‚¹ï¼Œç¼–æˆäº†ä¸€æœ¬ä¹¦å°±å«åšã€Šæœªæ¥ä¸–ç•Œçš„å¹¸å­˜è€…ã€‹ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘éƒ½å†™åœ¨è¿™æœ¬ä¹¦é‡Œäº†ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å±•å¼€äº†ã€‚</text>
                            <text class="text">åœ¨æˆ‘çœ‹æ¥ï¼Œå¤§è¶‹åŠ¿éƒ½å·²ç»ç¡®ç«‹äº†ï¼Œæ— æ³•æ”¹å˜äº†ï¼Œæœªæ¥äºŒä¸‰åå¹´é‡Œé¢å°±èƒ½çœ‹è§ç»“æœã€‚æˆ‘ä»¬å¿…é¡»èµ¶åœ¨ç»“å±€åˆ°æ¥ä¹‹å‰ï¼Œåšäº›ä»€ä¹ˆã€‚</text>
                            <text class="text">ä½†æ˜¯ï¼Œæˆ‘ç°åœ¨è¿˜ä¸çŸ¥é“ï¼Œåˆ°åº•èƒ½åšä»€ä¹ˆã€‚åªæœ‰å…ˆæŠŠæƒ³æ³•ä¼ æ’­å‡ºå»ï¼Œä¸€æ–¹é¢å¯ä»¥æé†’å…¶ä»–äººï¼Œå¦ä¸€æ–¹é¢ä¹Ÿè®¸å¯ä»¥æ‰¾åˆ°ä¸€äº›å¿—åŒé“åˆçš„æœ‹å‹ã€‚æˆ‘ä¸€ä¸ªäººèƒ½åšçš„æœ‰é™ï¼Œå¦‚æœä¸€ç¾¤äººï¼Œä¹Ÿè®¸çœŸçš„èƒ½åˆ›é€ ä¸€äº›æ”¹å˜ã€‚</text>
                            <text class="text">å¦‚æœæœªæ¥å¦‚é¢„æµ‹çš„é‚£æ ·ï¼Œæå°‘æ•°æœ‰æŠ€æœ¯çš„å¯Œäººæ§åˆ¶ä¸€åˆ‡ï¼Œå¤§å¤šæ•°äººæ²¦ä¸ºæ¯«æ— ä»·å€¼çš„æ— ç”¨é˜¶å±‚ï¼Œé‚£ä¹ˆç°åœ¨å°±è¦å¯»æ‰¾å‡ºè·¯ã€‚</text>
                        </view>
                    </i-collapse-item>
                </i-collapse>
                <i-icon i-class="audio-btn" size="50" color="#fedb1d" type="{{ audioIcon }}" @tap="playAudio" />
            </i-col>
        </i-row>
        <i-row wx:if="{{ current === 'location' }}">
            <i-col span="24">
                <map longitude="{{ longitude }}"
                    latitude="{{ latitude }}"
                    show-location
                    show-compass
                    scale="15"
                    style="width: 100%; height: 1500rpx;"
                    ></map>
            </i-col>
        </i-row>
        <i-row wx:if="{{ current === 'video' }}">
            <i-col span="24">
                <video style="width: 100%; height: 500rpx;"
                src="http://img.hellocode.name/linus.mp4"
                danmu-list="{{ danmuList }}"
                enable-danmu
                danmu-btn
                controls
                title="The mind behind Linux | Linus Torvalds"
                ></video>
            </i-col>
        </i-row>
        <tabbar></tabbar>
    </view>
</template>

<style>
.collapse-box {
    background: #fff;
}
.collapse-title {
    font-size: 34rpx;
    color: #495060;
}
.collapse-main {
    font-size: 30rpx;
    color: #80848f;
}
.text{
    display: block;
}
.audio-btn {
    margin-bottom: 100px;
    margin-left: 43%;
}
</style>

<script>
import wepy from 'wepy'
import tabbar from '@/components/tabbar'

export default class Other extends wepy.page {
    config = {
        navigationBarTitleText: 'å…¶ä»–',
        'usingComponents': {
            'i-tab-bar': '../components/iview-weapp/tab-bar/index',
            'i-tab-bar-item': '../components/iview-weapp/tab-bar-item/index',
            'i-row': '../components/iview-weapp/row/index',
            'i-col': '../components/iview-weapp/col/index',
            'i-tabs': '../components/iview-weapp/tabs/index',
            'i-tab': '../components/iview-weapp/tab/index',
            'i-collapse': '../components/iview-weapp/collapse/index',
            'i-collapse-item': '../components/iview-weapp/collapse-item/index',
            'i-cell-group': '../components/iview-weapp/cell-group/index',
            'i-cell': '../components/iview-weapp/cell/index',
            'i-icon': '../components/iview-weapp/icon/index'
        }
    }
    components = {
        tabbar
    }
    data = {
        audioIcon: 'playon',
        innerAudioContext: null,
        isAudioPlay: false,
        current: 'audio',
        latitude: '23.099994',
        longitude: '113.324520',
        danmuList: [
            { text: '666', color: '#bbbec4', time: 78 },
            { text: 'ä¼ è¯´ä¸­çš„ Linus ğŸ‘€ğŸ‘€', color: '#5FB878', time: 15 },
            { text: 'ğŸ‘½linus', color: '#19be6b', time: 120 },
            { text: '???ğŸ˜¸', color: '#01AAED', time: 56 },
            { text: 'hackerğŸ˜‚ğŸ˜‚ğŸ˜‚', color: '#5FB878', time: 45 },
            { text: 'hahaha', color: '#5FB878', time: 42 },
            { text: 'ğŸ˜‚ğŸ˜‚ğŸ˜‚', color: '#19be6b', time: 48 },
            { text: 'ğŸ˜¸ğŸ’€', color: '#2F4056', time: 89 }
        ]
    }
    playAudio() {
        if (this.innerAudioContext === null) {
            this.innerAudioContext = wx.createInnerAudioContext()
            this.innerAudioContext.src = 'http://img.hellocode.name/about.mp3'
            this.innerAudioContext.autoplay = true
        }
        if (this.innerAudioContext.isAudioPlay && this.innerAudioContext !== null) {
            this.innerAudioContext.pause()
            this.innerAudioContext.isAudioPlay = false
        } else {
            this.innerAudioContext.play()
            this.innerAudioContext.isAudioPlay = true
        }
        if (this.audioIcon === 'playon') {
            this.audioIcon = 'suspend'
        } else {
            this.audioIcon = 'playon'
        }
        this.$apply()
    }
    handleChange({ detail }) {
        this.current = detail.key
        if (this.innerAudioContext !== null) {
            this.innerAudioContext.pause()
            this.innerAudioContext.isAudioPlay = false
            if (this.audioIcon === 'playon') {
                this.audioIcon = 'suspend'
            } else {
                this.audioIcon = 'playon'
            }
        }
        if (detail.key === 'location') {
            this.locationSetting()
        }
        this.$apply()
    }
    locationSetting() {
        let $this = this
        wx.getLocation({
            type: 'gcj02',
            success(res) {
                $this.latitude = res.latitude
                $this.longitude = res.longitude
                $this.$apply()
            }
        })
    }
}
</script>
